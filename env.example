# AI Quality Kit Environment Configuration

# OpenAI Configuration
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_MODEL=gpt-4o-mini

# Anthropic Configuration
ANTHROPIC_API_KEY=your_anthropic_api_key_here
ANTHROPIC_MODEL=claude-3-sonnet-20240229

# Snowflake Configuration
SNOWFLAKE_ACCOUNT=your_account
SNOWFLAKE_USER=your_username
SNOWFLAKE_PASSWORD=your_password
SNOWFLAKE_WAREHOUSE=your_warehouse
SNOWFLAKE_DATABASE=your_database
SNOWFLAKE_SCHEMA=your_schema

# RAG Configuration
RAG_TOP_K=4
RAG_SIMILARITY_THRESHOLD=0.7

# Cache Configuration
CACHE_TTL_HOURS=24
CACHE_ENABLED=true

# Logging Configuration
LOG_LEVEL=INFO
ENABLE_LOGGING=true

# Evaluation Configuration
ENABLE_LIVE_EVAL=true
RAGAS_THRESHOLD=0.8

# Negative Testing Configuration
ENABLE_NEGATIVE_TESTS=true
NEGATIVE_FAITHFULNESS_MAX=0.60
NEGATIVE_CONTEXT_RECALL_MAX=0.60
NEGATIVE_FORCE_IDK=true

# Security & Privacy
AUTH_ENABLED=true

# Authentication Mode: 'token' (default) or 'jwt'
AUTH_MODE=token

# Token-based Authentication (when AUTH_MODE=token)
AUTH_TOKENS=admin:SECRET_ADMIN,user:SECRET_USER

# JWT Authentication (when AUTH_MODE=jwt)
# Option 1: Symmetric Key (HS256)
JWT_SECRET=your-secret-key-256-bits-minimum-for-production
JWT_ISSUER=ai-quality-kit
JWT_AUDIENCE=api-client

# Option 2: Asymmetric Key (RS256) with JWKS
# JWT_JWKS_URL=https://your-auth-provider.com/.well-known/jwks.json
# JWT_ISSUER=https://your-auth-provider.com
# JWT_AUDIENCE=your-api-audience

# Role-Based Access Control (applies to both token and JWT modes)
RBAC_ALLOWED_ROUTES=/ask:user|admin,/orchestrator/*:user|admin,/reports/*:user|admin,/a2a/*:user|admin,/mcp/*:user|admin,/testdata/*:user|admin

# Audit & Privacy
AUDIT_LOG_ENABLED=false
PERSIST_DB=false                 # no user data written to DB by default
PERSIST_ONLY_AGGREGATES=false    # optional anonymized aggregates only (no raw text)

# Observability
PERF_COLD_WINDOW_SECONDS=120
PERF_PERCENTILES_ENABLED=false
PERF_WINDOW=500

# Providers (defaults; UI may override per request)
PROVIDER=openai
MODEL_NAME=gpt-4o-mini
ANTHROPIC_MODEL=claude-3-5-sonnet
GEMINI_MODEL=gemini-1.5-pro
GOOGLE_API_KEY=
ALLOWED_PROVIDERS=openai,anthropic,gemini,custom_rest,mock
CUSTOM_LLM_BASE_URL=http://localhost:11434

# Modes & UI/Reports
MCP_ENABLED=true
A2A_ENABLED=true
OFFLINE_MODE=false
UI_ENABLED=false
REPORTS_DIR=./reports
REPORT_AUTO_DELETE_MINUTES=10
ANONYMIZE_REPORTS=true

# Orchestrator
DEFAULT_TEST_SUITES=rag_quality,red_team,safety,performance,regression
RAGAS_SAMPLE_SIZE=8

# ===== Rate Limiting =====
# Enable/disable rate limiting middleware
RL_ENABLED=true

# Per-token rate limits (authenticated requests)
RL_PER_TOKEN_PER_MIN=60        # Sustained rate: 60 requests per minute
RL_PER_TOKEN_BURST=10          # Burst capacity: 10 requests

# Per-IP rate limits (all requests from same IP)
RL_PER_IP_PER_MIN=120          # Sustained rate: 120 requests per minute
RL_PER_IP_BURST=20             # Burst capacity: 20 requests

# Optional Redis backend for distributed rate limiting
# REDIS_URL=redis://localhost:6379

# ===== Test Data Storage =====
# Redis backend for persistent test data storage
# REDIS_URL=redis://localhost:6379
REDIS_PREFIX=aqk:
TESTDATA_TTL_HOURS=24

# ===== Provider Resilience =====
# Timeouts and retries for LLM provider calls
PROVIDER_TIMEOUT_S=20                  # Request timeout in seconds
PROVIDER_MAX_RETRIES=2                 # Maximum retry attempts
PROVIDER_BACKOFF_BASE_MS=200           # Base backoff time in milliseconds
PROVIDER_CIRCUIT_FAILS=5               # Failures before circuit opens
PROVIDER_CIRCUIT_RESET_S=30            # Circuit reset time in seconds

# ===== JWT Authentication (Enhanced) =====
# Required for JWT mode
JWT_ISSUER=https://your-auth-provider.com     # Required in JWT mode
JWT_AUDIENCE=https://your-api.com              # Required in JWT mode

# ===== Audit Logging =====
AUDIT_ENABLED=true                            # Enable structured audit logs
AUDIT_REDACT_FIELDS=answer,text,inputs,content,response  # Fields to redact for PII protection
