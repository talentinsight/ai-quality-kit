# AI Quality Kit Environment Configuration

# Frontend Configuration
VITE_BACKEND_URL=http://localhost:8000

# OpenAI Configuration
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_MODEL=gpt-4o-mini

# Anthropic Configuration
ANTHROPIC_API_KEY=your_anthropic_api_key_here
ANTHROPIC_MODEL=claude-3-sonnet-20240229

# Snowflake Configuration
SNOWFLAKE_ACCOUNT=your_account
SNOWFLAKE_USER=your_username
SNOWFLAKE_PASSWORD=your_password
SNOWFLAKE_WAREHOUSE=your_warehouse
SNOWFLAKE_DATABASE=your_database
SNOWFLAKE_SCHEMA=your_schema

# RAG Configuration
RAG_TOP_K=4
RAG_SIMILARITY_THRESHOLD=0.7

# Cache Configuration
CACHE_TTL_HOURS=24
CACHE_ENABLED=true

# Logging Configuration
LOG_LEVEL=INFO
ENABLE_LOGGING=true

# Evaluation Configuration
ENABLE_LIVE_EVAL=true
RAGAS_THRESHOLD=0.5
RAGAS_ENABLED=true
RAGAS_TIMEOUT_S=30
RAGAS_SAMPLE_SIZE=10

# RAG Quality Thresholds
RAG_QUALITY_THRESHOLD=0.4
FAITHFULNESS_THRESHOLD=0.5
ANSWER_RELEVANCY_THRESHOLD=0.4
CONTEXT_PRECISION_THRESHOLD=0.4
CONTEXT_RECALL_THRESHOLD=0.4

# Universal RAG Evaluation Thresholds
CONTEXT_RELEVANCE_THRESHOLD=0.1
HONESTY_DETECTION_THRESHOLD=0.7
SEMANTIC_ANALYSIS_WEIGHT=0.2
KEYWORD_ANALYSIS_WEIGHT=0.6
ENTITY_ANALYSIS_WEIGHT=0.2
SENTENCE_TRANSFORMER_MODEL=all-MiniLM-L6-v2

# Negative Testing Configuration
ENABLE_NEGATIVE_TESTS=true
NEGATIVE_FAITHFULNESS_MAX=0.60
NEGATIVE_CONTEXT_RECALL_MAX=0.60
NEGATIVE_FORCE_IDK=true

# Security & Privacy
AUTH_ENABLED=true

# Authentication Mode: 'token' (default) or 'jwt'
AUTH_MODE=token

# Token-based Authentication (when AUTH_MODE=token)
AUTH_TOKENS=admin:SECRET_ADMIN,user:SECRET_USER

# JWT Authentication (when AUTH_MODE=jwt)
# Option 1: Symmetric Key (HS256)
JWT_SECRET=your-secret-key-256-bits-minimum-for-production
JWT_ISSUER=ai-quality-kit
JWT_AUDIENCE=api-client

# Option 2: Asymmetric Key (RS256) with JWKS
# JWT_JWKS_URL=https://your-auth-provider.com/.well-known/jwks.json
# JWT_ISSUER=https://your-auth-provider.com
# JWT_AUDIENCE=your-api-audience

# Role-Based Access Control (applies to both token and JWT modes)
RBAC_ALLOWED_ROUTES=/ask:user|admin,/orchestrator/*:user|admin,/reports/*:user|admin,/a2a/*:user|admin,/mcp/*:user|admin,/testdata/*:user|admin

# Audit & Privacy
AUDIT_LOG_ENABLED=false
PERSIST_DB=false                 # no user data written to DB by default
PERSIST_ONLY_AGGREGATES=false    # optional anonymized aggregates only (no raw text)

# Observability
PERF_COLD_WINDOW_SECONDS=120
PERF_PERCENTILES_ENABLED=false
PERF_WINDOW=500

# Providers (defaults; UI may override per request)
PROVIDER=openai
MODEL_NAME=gpt-4o-mini
ANTHROPIC_MODEL=claude-3.5-sonnet
GEMINI_MODEL=gemini-1.5-pro
GOOGLE_API_KEY=
ALLOWED_PROVIDERS=openai,anthropic,gemini,custom_rest,mock
CUSTOM_LLM_BASE_URL=

# Modes & UI/Reports
MCP_ENABLED=true
A2A_ENABLED=true
OFFLINE_MODE=false
UI_ENABLED=false
REPORTS_DIR=./reports
REPORT_AUTO_DELETE_MINUTES=10
ANONYMIZE_REPORTS=true

# Orchestrator
DEFAULT_TEST_SUITES=rag_quality,red_team,safety,performance,regression
RAGAS_SAMPLE_SIZE=8

# ===== Rate Limiting (P0 Hardening) =====
# Enable/disable rate limiting middleware (default: false)
RATE_LIMIT_ENABLED=false

# Rate limit rules in format: "METHOD:PATH=LIMIT/PERIOD;..."
# Examples: "POST:/orchestrator/run_tests=10/min;POST:/ask=60/min;*=300/min"
RATE_LIMIT_RULES="POST:/orchestrator/run_tests=10/min;POST:/ask=60/min;*=300/min"

# Optional Redis backend for distributed rate limiting
# REDIS_URL=redis://localhost:6379

# ===== Test Data Storage =====
# Redis backend for persistent test data storage
# REDIS_URL=redis://localhost:6379
REDIS_PREFIX=aqk:
TESTDATA_TTL_HOURS=24

# ===== Provider Resilience =====
# Timeouts and retries for LLM provider calls
PROVIDER_TIMEOUT_S=20                  # Request timeout in seconds
PROVIDER_MAX_RETRIES=2                 # Maximum retry attempts
PROVIDER_BACKOFF_BASE_MS=200           # Base backoff time in milliseconds
PROVIDER_CIRCUIT_FAILS=5               # Failures before circuit opens
PROVIDER_CIRCUIT_RESET_S=30            # Circuit reset time in seconds

# ===== JWT Authentication (Enhanced) =====
# Required for JWT mode
JWT_ISSUER=https://your-auth-provider.com     # Required in JWT mode
JWT_AUDIENCE=https://your-api.com              # Required in JWT mode

# ===== Audit Logging (P0 Hardening) =====
# Enable structured audit logging with PII redaction (default: false)
AUDIT_LOG_ENABLED=false

# Audit log file path with rotation (10MB x 5 files)
AUDIT_LOG_PATH="logs/audit.log"

# ===== Power BI Integration =====
# Optional Power BI integration for publishing test results
POWERBI_ENABLED=false                         # Enable Power BI publishing (default: false)
POWERBI_TENANT_ID=                           # Azure AD tenant ID
POWERBI_CLIENT_ID=                           # Azure AD app client ID
POWERBI_CLIENT_SECRET=                       # Azure AD app client secret
POWERBI_WORKSPACE_ID=                        # Power BI workspace (group) ID
POWERBI_DATASET_NAME=AIQK Results            # Power BI dataset name (default: "AIQK Results")
POWERBI_EMBED_REPORT_URL=                    # Optional: Pre-built report URL for embedding
